{% extends "main/layout.html" %} {% block content %} {% load static %}
<section
  class="min-h-screen flex items-center justify-center text-black font-bold"
>
  <div class="mx-auto px-4 text-center" data-aos="zoom-out-down">
    <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">
      Dinámico, enfocado en perifericos y electrónica
    </h1>
    <p class="text-xl md:text-2xl mb-8 text-gray-600 font-semibold mx-auto">
      Conectamos la última tecnología con tu día a día, ofreciéndote
      dispositivos que transforman cómo trabajas, juegas y vives. Descubre
      productos cuidadosamente seleccionados que combinan diseño excepcional,
      rendimiento superior y la calidad que mereces.
    </p>
  </div>
</section>
<hr />
<section
  class="min-h-screen flex items-start justify-center pt-6 pb-22 md:flex-row flex-col"
>
  <div data-aos="fade-up" class="sticky top-[30%] z-30">
    <h2
      class="text-4xl md:text-5xl font-bold text-center mb-4 p-6 text-gray-800"
    >
      Nuestros Productos
    </h2>
    <p class="text-center text-gray-600 mb-12 text-lg max-w-2xl mx-auto">
      Encuentra lo que necesitas, cuando lo necesitas
    </p>
  </div>
  <div class="max-w-6xl mx-auto px-4 w-full">
    <form id="form_with_token">{% csrf_token %}</form>
    <div class="gap-2 flex flex-wrap justify-center">
      {% if products %} {% for product in products %}
      <div
        data-aos="{{ product.aos_animacion }}"
        data-aos-delay="{{ product.aos_retraso }}"
        class="bg-[#F5E6CF] border-2 border-black max-w-[240px] w-full"
      >
        <img
          src="{{product.img.url}}"
          alt="Desarrollo Web"
          class="w-full h-32 object-cover"
        />
        <div class="w-full flex gap-1 p-1 pb-2 flex-col">
          <h3 class="font-bold text-black">{{product.name}}</h3>
          <p class="font-bold text-orange-600">${{product.price}}</p>
          <p
            class="text-gray-600 leading-relaxed truncate text-ellipsis max-w-[200ch]"
          >
            {{product.description}}
          </p>
          <button
            type="button"
            data-url-base="{% url 'shopping_cart:add' product.id %}"
            class="btn-add-cart btn bg-orange-500 mx-auto"
          >
            Agregar al carrito
          </button>
        </div>
      </div>
      {% endfor %} {% else %}
      <div
        data-aos="flip-up"
        class="bg-white rounded-lg shadow-lg p-8 text-center flex-1"
      >
        <div class="mb-6 flex justify-center">
          <div
            class="w-20 h-20 bg-gradient-to-br from-purple-200 to-purple-100 rounded-full flex items-center justify-center"
          >
            <svg
              class="w-10 h-10 text-purple-600"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"
              ></path>
            </svg>
          </div>
        </div>

        <h2 class="text-2xl font-bold text-purple-900 mb-2">Sin productos</h2>
        <p class="text-gray-600 mb-6 leading-relaxed">
          No encontramos productos para mostrar. Intenta a recargar la pagina o
          crear alguno.
        </p>
      </div>
      {% endif %}
    </div>
  </div>

  <script>
    const addToCart = async (url) => {
      try {
        const csrftoken = document
          .querySelector('meta[name="csrf-token"]')
          .getAttribute("content");

        const resp = await fetch(window.location.href + url.replace("/", ""), {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": csrftoken,
          },
        });

        let statusClass = "#16B981";
        const data = await resp.json();
        if (data.status != "ok") statusClass = "#FF6467";

        Toastify({
          text: data.message,
          duration: 3000,
          className: "btn",
          position: "right",
          style: {
            color: "black",
            background: statusClass,
          },
        }).showToast();
      } catch (e) {
        Toastify({
          text: data.message,
          duration: 3000,
          className: "btn",
          position: "right",
          style: {
            color: "black",
            background: "#FF6467",
          },
        }).showToast();
      }
    };
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const buttons = document.querySelectorAll(".btn-add-cart");
      [...buttons].forEach((btn) => {
        btn.addEventListener("click", (e) => {
          const url = btn.getAttribute("data-url-base");
          addToCart(url);
        });
      });
    });
  </script>
</section>

{% endblock %}
